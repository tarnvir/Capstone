from ipaddress import IPv4Address
from typing import List

from CybORG.Shared import Observation
from CybORG.Simulator.Actions.ConcreteActions.ExploitActions.ExploitAction import ExploitAction
from CybORG.Simulator.Host import Host
from CybORG.Simulator.Process import Process
from CybORG.Simulator.State import State


class SQLInjection(ExploitAction):
    PORT = 3390
    WEIGHT = 5.0

    @classmethod
    def get_weight(cls, ports: List[int]) -> float:
        return cls.WEIGHT if (cls.PORT in ports) and (80 in ports or 443 in ports) else 0.0

    def execute(self, state: State) -> Observation:
        return self.sim_exploit(state, 'mysql')

    def test_exploit_works(self, target_host: Host, vuln_proc: Process, **kwargs):
        # ask Max on what properties to check
        return True
